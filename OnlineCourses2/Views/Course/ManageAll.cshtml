@model List<OnlineCourses2.Models.Course>

@{
    ViewData["Title"] = "Управление на всички курсове";
}

<main style="max-width: 1100px; margin: 40px auto; padding: 0 20px;">
    <div style="display: flex; justify-content: flex-end; margin-bottom: 25px;">
        <a asp-controller="Course" asp-action="Create"
           style="background-color: #81d8b0; color: white; padding: 10px 20px;
                  border-radius: 6px; text-decoration: none; font-weight: 500;">
            Създай курс
        </a>
    </div>
    <h3 style="margin-bottom: 20px;">Всички курсове</h3>

    @if (TempData["Success"] != null)
    {
        <div id="successMessage"
             style="background:#81d8b0; color:white; padding:10px 15px;
                        border-radius:6px; margin-bottom:20px; font-weight:500;">
            @TempData["Success"]
        </div>
    }

    @if (Model.Count == 0)
    {
        <p style="text-align:center; color:#555;">Няма създадени курсове.</p>
    }
    else
    {
        <div style="
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                    gap: 25px;
                ">
            @foreach (var course in Model)
            {
                <div style="
                                    background: white;
                                    border-radius: 10px;
                                    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
                                    overflow: hidden;
                                ">

                    @if (!string.IsNullOrEmpty(course.ImagePath))
                    {
                        <img src="@course.ImagePath"
                             style="width:100%; height:180px; object-fit:cover;" />
                    }
                    else
                    {
                        <div style="
                                                    width:100%; height:180px; background:#e0e0e0;
                                                    display:flex; align-items:center; justify-content:center; color:#777;">
                            Няма снимка
                        </div>
                    }

                    <div style="padding: 15px;">
                        <h4>@course.Title</h4>
                        <p>Категория: @course.Category?.Name</p>
                        <p>Организатор: @course.Organizer?.Email</p>
                        <p style="font-size:14px; margin-top:5px;">
                            <span style="
                                        padding:4px 8px;
                                        border-radius:6px;
                                                background:@(course.HasCertificate ? "#81d8b0" : "#bdc3c7");
                                        color:white;
                                        font-size:12px;">
                                @(course.HasCertificate ? "Сертификат: Да" : "Сертификат: Не")
                            </span>
                        </p>
                        <p>Цена: @course.Price лв.</p>

                        <div style="display:flex; gap:10px; margin-top:15px;">

                            <a asp-controller="Course" asp-action="Edit" asp-route-id="@course.Id"
                               style="background:#bfbfbf; color:white; padding:10px 20px;
                                                      border-radius:6px; text-decoration:none; font-weight:500;">
                                Редактирай
                            </a>

                            <form asp-controller="Course" asp-action="Delete" asp-route-id="@course.Id" method="post"
                                  onsubmit="return confirm('Сигурни ли сте, че искате да изтриете този курс?');">
                                <button type="submit"
                                        style="background:#81d8b0; color:white; border:none;
                                                               padding:10px 20px; border-radius:6px; font-weight:500;">
                                    Изтрий
                                </button>
                            </form>

                        </div>
                    </div>

                </div>
            }
        </div>
    }

</main>

@section Scripts {
    <script>
        setTimeout(() => {
            const alert = document.getElementById("successMessage");
            if (alert) alert.style.display = "none";
        }, 3000);
    </script>
}